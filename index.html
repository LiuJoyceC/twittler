<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var $body = $('body');
        //$body.html('');   <!-- Commented out so header is not erased -->

        var createTweetLine = function(tweet) {
          var $tweet = $('<div></div>');
          var $atUsername = $('<span class="at-username"></span>');
          var $timestamp = $('<span class-"timestamp"></span>');
          $atUsername.text('@' + tweet.user);
          $atUsername.attr('data-username', tweet.user);
          $timestamp.text(tweet.created_at);
          $tweet.text(/*'@' + tweet.user + */': ' + tweet.message + " ");
          $tweet.prepend($atUsername);
          $tweet.append($timestamp);
          return $tweet;
        };

        var prevLength = streams.home.length;
        var index = prevLength - 1;
        while(index >= 0){
          var tweet = streams.home[index];
/*          var $tweet = $('<div></div>');
          $tweet.text('@' + tweet.user + ': ' + tweet.message);  <-- Moved to createTweetLine above */
          var $tweet = createTweetLine(tweet);
          $tweet.appendTo($body);
          index -= 1;
        }

        $('button').click(function() {
          var newLength = streams.home.length;
          if (newLength > prevLength) {
            for (index = prevLength; index < newLength; index++) {
              var tweet = streams.home[index];
              var $tweet = createTweetLine(tweet);
              $tweet.insertAfter($('.tweet-begin'));
            }
          }
        })

      });

    </script>

    <!-- HTML portion -->

    <!-- Header -->

    <header>
      <h1>myTwittler</h1>
    </header>

    <!-- Tweets section -->

    <button>See new Tweets!</button>

    <!-- Beginning divider for tweets: this should be the last item in the body section of the html -->

    <div class="tweet-begin"></div>

  </body>
</html>
